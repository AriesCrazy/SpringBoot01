<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.by.dao.ProductPriceDao">
    <resultMap type="com.by.entity.ProductPrice" id="ProductPriceMap">
        <result property="id" column="id" />
        <result property="productId" column="product_id" />
        <result property="price" column="price" />
        <result property="status" column="status" />
        <result property="brief" column="brief" />
        <result property="lastUpdateBy" column="lastUpdateBy" />
        <result property="lastUpdateTime" column="lastUpdateTime" />
    </resultMap>


    <!--通用查询-->
    <select id="select" resultMap="ProductPriceMap">
        select
        id,product_id,price,status,brief,lastUpdateBy,lastUpdateTime
        from product_price
        <where>
            <if test="productId != null">
                and product_id = #{productId}
            </if>
            <if test="status != null">
                and status = #{status}
            </if>
        </where>
        order by lastUpdateTime desc
    </select>
    
    <!--新增数据-->
    <insert id="insert" keyProperty="id" useGeneratedKeys="true">
        insert into product_price(id,product_id,price,status,brief,lastUpdateBy)
        values (#{id},#{productId},#{price},#{status},#{brief},#{lastUpdateBy})
    </insert>
    
    <!-- 批量新增数据 -->
    <insert id="insertBatch" keyProperty="id" useGeneratedKeys="true">
        insert into product_price(id,product_id,price,status,lastUpdateBy)
        values
        <foreach collection="entities" item="entity" separator=",">
            (#{entity.id},#{entity.productId},#{entity.price},#{entity.status},#{entity.lastUpdateBy})
        </foreach>
    </insert>
    
    <!-- 更新数据 -->
    <update id="update">
        update product_price
        <set>
            <if test="id != null and id != ''">
                id = #{id},
            </if>
            <if test="productId != null and productId != ''">
                product_id = #{productId},
            </if>
            <if test="price != null and price != ''">
                price = #{price},
            </if>
            <if test="status != null and status != ''">
                status = #{status},
            </if>
            <if test="lastUpdateBy != null and lastUpdateBy != ''">
                lastUpdateBy = #{lastUpdateBy},
            </if>
        </set>
        where id = #{id}
    </update>
    
    <!--通过主键软删除-->
    <!--<update id="delete">
        update  product_price set status = 120 where id = #{id}
    </update>-->

    <delete id="delete">
        delete from product_price
        where id = #{id}
    </delete>

</mapper>